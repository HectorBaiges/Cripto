import hashlib



F1 = 0x0095643356888869d03b25edb319e508c2be34e397b4dc59e05eb037cb25252b41
F2 = 0x00ef666eb3f977274a81b2535e343053053829532a00f808ff42efaa916a2f43c8
RandomBytesClient = 0x3a1b363cb9c4d2597e8a62f37ed699791c0e6ca4d8a70a3f3a94f413
RandomBytesServer = 0x6f6eabb50f2506d8c4bc94fbadc254c0d846c98530c4103819373338
ECDHParams1 = 0x03001d207018ba0d3f9e16a5924889b6491684caa8c6155735b9b0764144428b50727f17
ECDHParams = 0x205f8490a28cf5ae4d4d42b13a34a62dc1d6953ca8190b183828eafc6e0fd9e620


aux = 0x848920e13a1b363cb9c4d2597e8a62f37ed699791c0e6ca4d8a70a3f3a94f413b0e942476f6eabb50f2506d8c4bc94fbadc254c0d846c98530c410381937333803001d207018ba0d3f9e16a5924889b6491684caa8c6155735b9b0764144428b50727f17
#aux = 0x3a1b363cb9c4d2597e8a62f37ed699791c0e6ca4d8a70a3f3a94f4136f6eabb50f2506d8c4bc94fbadc254c0d846c98530c4103819373338205f8490a28cf5ae4d4d42b13a34a62dc1d6953ca8190b183828eafc6e0fd9e620
aux2 = RandomBytesClient + RandomBytesServer + ECDHParams1
print("to bytes")
print(aux2)

print("concatenado")
print(aux)
"""
Mensaje = hashlib.sha512()
f2329538329aff19884688355b9f748296bc838e3e8e564a3828d320faaeb18d676154fab6a2fb864f9b540088b28c614a778bdaa0b3c39164e1ea59ce9ea78a
Mensaje.update(aux.encode())
nombre = Mensaje.digest()

print(hex(int.from_bytes(nombre[:32], "big")))


Mensaje = hashlib.sha512(aux.encode()).digest()
print("big")
print(hex(int.from_bytes(Mensaje[:32], "big")))
"""
Mensaje = hashlib.sha512(str(aux).encode()).hexdigest()
Mensaje = Mensaje[:32]
print(Mensaje)

q = 0xFFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551
p1 = 0x6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296
p2 = 0x4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5
"""
sagemath

F1 = 0x0095643356888869d03b25edb319e508c2be34e397b4dc59e05eb037cb25252b41
F2 = 0x00ef666eb3f977274a81b2535e343053053829532a00f808ff42efaa916a2f43c8
RandomBytesClient = 0x3a1b363cb9c4d2597e8a62f37ed699791c0e6ca4d8a70a3f3a94f413
RandomBytesServer = 0x6f6eabb50f2506d8c4bc94fbadc254c0d846c98530c4103819373338
ECDHParams = 0x

aux = 0xf2329538329aff19884688355b9f7482

a = 0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc
b = 0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b
q = 0xFFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551

Zp = Zmod(0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff)
E = EllipticCurve(Zp,[a,b])

Punto = (0x6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296,0x4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5)
P = E([0x6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296,0x4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5])
Q = E([0x23551f0b79e4822143c07d2b3f4570a67ed537197fe77ff14acdb3d220021724,0x19b80ac6d1582b114cfafa89bab7ab1b8acaaeacbad7e3588fc94aa406279e9c])

Mensaje = 0xf2329538329aff19884688355b9f748296bc838e3e8e564a3828d320faaeb18d

w1 = int(mod(Mensaje * inverse_mod(F2,q),q))
w2 = int(mod(F1 * inverse_mod(F2,q),q))
result = w1 * P + w2 *Q
mod(result[0],q) == F1 

fd35a3d1a91821de94dd10ad07ae2f7e4c529f45b7396b15ddcb0533b2bbcf968a4fd6164137f8068ea56ca4dd847e59
fccd4d7ede1ea5c4f46c3f64c1a933311929770bc30ff399c525e76feb67d0ba24b316d914279f496ed2955be465b5f1
"""

paca = 0x7018ba0d3f9e16a5924889b6491684caa8c6155735b9b0764144428b50727f17
pacb = 0x7018ba0d3f9e16a5924889b6491684caa8c6155735b9b0764144428b50727f17